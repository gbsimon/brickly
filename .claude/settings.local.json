{
  "permissions": {
    "allow": [
      "Bash(find:*)",
      "Bash(cd:*)",
      "Bash(ls:*)",
      "Bash(cd /Users/simongauthier/Local\\\\ Sites/_Custom\\\\ Apps/Brickly && npx tsc:*)",
      "Bash(cd /Users/simongauthier/Local\\\\ Sites/_Custom\\\\ Apps/Brickly && npx prisma generate:*)",
      "Bash(npm run build)",
      "Bash(npx tsc:*)",
      "Bash(git ls-tree -r 3065d83 lib/db/)",
      "Bash(git ls-tree -r 3065d83 app/api/)",
      "Bash(git show 3065d83:app/api/sets/[setNum]/route.ts)",
      "Bash(git show 3065d83:app/api/sets/[setNum]/progress/route.ts)",
      "Bash(git show 3065d83:app/api/sets/[setNum]/ongoing/route.ts)",
      "Bash(npm install:*)",
      "WebFetch(domain:www.prisma.io)",
      "Bash(node -e \"\nconst postgres = require\\(''postgres''\\);\nconst sql = postgres\\(process.env.DATABASE_URL, { ssl: ''require'' }\\);\nsql\\\\`SELECT 1 as ok\\\\`.then\\(r => { console.log\\(''DB connected:'', r[0]\\); return sql.end\\(\\); }\\).catch\\(e => { console.error\\(''DB error:'', e.message\\); process.exit\\(1\\); }\\);\n\")",
      "Bash(node -e \"\nrequire\\(''dotenv''\\).config\\(\\);\nconst postgres = require\\(''postgres''\\);\nconst url = process.env.DATABASE_URL;\nconsole.log\\(''Connecting to:'', url ? url.replace\\(/:[^:@]+@/, '':***@''\\) : ''NOT SET''\\);\nconst sql = postgres\\(url, { ssl: ''require'', connect_timeout: 10 }\\);\nsql\\\\`SELECT 1 as ok\\\\`.then\\(r => { console.log\\(''Connected OK''\\); return sql.end\\(\\); }\\).catch\\(e => { console.error\\(''Error:'', e.message || e\\); process.exit\\(1\\); }\\);\n\")",
      "Bash(node -e \"\nrequire\\(''dotenv''\\).config\\(\\);\nconst postgres = require\\(''postgres''\\);\nconst sql = postgres\\(process.env.DATABASE_URL, { ssl: ''require'', connect_timeout: 10 }\\);\n\nasync function migrate\\(\\) {\n  // 1. Add email_verified column\n  await sql\\\\`ALTER TABLE users ADD COLUMN IF NOT EXISTS email_verified TIMESTAMPTZ\\\\`;\n  console.log\\(''Added email_verified column to users''\\);\n\n  // 2. Create accounts table\n  await sql\\\\`\n    CREATE TABLE IF NOT EXISTS accounts \\(\n      id TEXT PRIMARY KEY DEFAULT gen_random_uuid\\(\\)::text,\n      user_id TEXT NOT NULL REFERENCES users\\(id\\) ON DELETE CASCADE,\n      type TEXT NOT NULL,\n      provider TEXT NOT NULL,\n      provider_account_id TEXT NOT NULL,\n      refresh_token TEXT,\n      access_token TEXT,\n      expires_at INTEGER,\n      token_type TEXT,\n      scope TEXT,\n      id_token TEXT,\n      session_state TEXT,\n      UNIQUE\\(provider, provider_account_id\\)\n    \\)\n  \\\\`;\n  console.log\\(''Created accounts table''\\);\n\n  await sql\\\\`CREATE INDEX IF NOT EXISTS idx_accounts_user_id ON accounts\\(user_id\\)\\\\`;\n  console.log\\(''Created accounts index''\\);\n\n  // 3. Create verification_tokens table\n  await sql\\\\`\n    CREATE TABLE IF NOT EXISTS verification_tokens \\(\n      identifier TEXT NOT NULL,\n      token TEXT NOT NULL,\n      expires TIMESTAMPTZ NOT NULL,\n      UNIQUE\\(identifier, token\\)\n    \\)\n  \\\\`;\n  console.log\\(''Created verification_tokens table''\\);\n\n  // Verify\n  const tables = await sql\\\\`\n    SELECT table_name FROM information_schema.tables\n    WHERE table_schema = ''public''\n    ORDER BY table_name\n  \\\\`;\n  console.log\\(''\\\\nAll tables:'', tables.map\\(t => t.table_name\\).join\\('', ''\\)\\);\n\n  await sql.end\\(\\);\n}\n\nmigrate\\(\\).catch\\(e => { console.error\\(''Migration failed:'', e.message\\); process.exit\\(1\\); }\\);\n\")",
      "Bash(curl:*)"
    ]
  }
}
